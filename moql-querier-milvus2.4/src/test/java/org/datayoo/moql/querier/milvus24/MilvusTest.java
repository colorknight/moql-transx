package org.datayoo.moql.querier.milvus24;

import com.google.gson.Gson;
import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import io.milvus.v2.client.ConnectConfig;
import io.milvus.v2.client.MilvusClientV2;
import io.milvus.v2.service.collection.request.*;
import org.datayoo.moql.RecordSet;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;
import java.util.Arrays;
import java.util.List;

public class MilvusTest {

  MilvusClientV2 milvusClient;

  @Before
  public void setUp() throws Exception {
    String url = String.format("%s://%s:%d", "http" ,"datayoo05"
        , 19530);
    ConnectConfig connectConfig = ConnectConfig.builder()
        .uri(url)
        .build();

    milvusClient = new MilvusClientV2(connectConfig);
  }

  @After
  public void tearDown() throws Exception {
    if (milvusClient == null) {
      return;
    }
    try {
      milvusClient.close();
    } finally {
      milvusClient = null;
    }
  }

  @Test
  public void query1() throws IOException {
    String collection  = "hybrid_search_collection";
    String sql = "select * from hybrid_search_collection a, (select * from hybrid_search_collection where vmatch(dense, 'L2', '[[-0.013192337,-0.026113132,0.06800578,0.0114197815,0.042541325,0.02653553,-0.028722938,-0.032343477,0.043144748,0.08230691,0.039494038,-0.1615967,-0.1160986,0.08284999,-0.0882808,-0.009473742,0.025358854,-0.07379864,0.008727006,-0.004182476,-0.037201032,-0.021602545,0.08351375,-0.072833166,-0.13625292,-0.011163327,0.034908023,0.010288363,0.052618492,-0.16569997,-0.02827037,-0.03689932,-0.05216592,-0.077358834,-0.120865636,0.034908023,0.013758046,-0.11241771,-0.104633555,-0.14602838,0.026309246,-0.09781488,-0.032554675,0.04966172,0.03024658,0.03876993,-0.014912092,-0.0139013585,0.057958785,0.030427609,0.030261666,0.069031596,-0.07096255,0.15483835,-0.17752707,-0.13202897,-0.014512325,0.03433477,-0.08423786,-0.04815316,0.0027946031,0.07856568,-0.045196388,0.017499268,0.10915923,0.05967854,-0.035933845,-0.0021610088,-0.037321717,-0.065531746,0.06879023,0.017107043,0.0037336801,-0.027531177,-0.041937903,-0.0026173475,-0.0071731918,0.07458309,0.06559209,-0.007919928,0.038166508,-0.030925432,-0.09962515,-0.064747296,-0.018706115,-0.04637306,-0.11561586,0.034938194,0.007214677,0.048273847,-0.0016075567,-0.08284999,0.026369588,-0.038377706,0.020727582,-0.013373364,-0.022673622,-0.013433706,0.012392801,0.03632607,-0.06426456,0.054036535,-0.040881913,0.020199588,0.059256144,0.013629818,0.05995008,-0.040851742,-0.103547394,0.038860444,-0.02550971,-0.016020883,-0.017997093,0.042209443,0.07615199,0.004257904,0.03846822,0.030231494,0.0073240474,0.0040617916,-0.0047217854,0.15592451,-0.0122796595,-0.035511445,0.021964598,0.034455456,0.08079835,-0.10849547,0.050295312,-0.037020005,0.027516091,0.060402647,0.0028096887,-0.049299665,-0.0737383,-0.08134143,0.026203647,-0.04739888,0.02199477,-0.03213228,0.06559209,0.06806612,0.0423603,0.0060794875,-0.024876116,0.006004059,0.035692476,0.072531454,-0.065773115,0.03852856,-0.039463867,-0.01060516,-0.020199588,0.06486798,-0.017076872,0.05675194,-0.028813452,0.010190307,0.047791105,0.008463008,0.03379169,-0.01444444,-0.00059965166,0.08128109,-0.014316212,-0.0026475186,-0.028858708,-0.021662887,-0.010854072,0.02861734,0.02250768,-0.0069808504,0.008749634,0.008191468,-0.019747019,-0.017499268,-0.02513257,0.041726705,-0.010514647,0.05892426,0.02956773,-0.0062642857,-0.053433113,0.02104438,-0.01688076,-0.07168666,0.03539076,0.0071241637,0.050868563,-0.041243967,0.006592397,0.023955895,-0.068971254,-0.055394236,-0.011563094,0.028964307,-0.016307509,-0.056208856,-0.0502048,-0.033640835,0.0104543045,-0.033308953,0.11670202,0.012490857,-0.032071937,0.009948937,0.0077238153,-0.03683898,-0.018872056,-0.01844966,0.0027342606,-0.015304318,-0.05732519,-0.020712497,0.0441404,-0.012068462,0.03514939,0.025057143,0.015734257,-0.04136465,-0.035722647,-0.0059286314,0.010725845,-0.019022912,0.034515798,-0.029718585,0.024498977,-0.045890324,0.029990125,-0.010167679,-0.07072118,-0.017997093,0.019656505,0.032373648,-0.019384965,-0.03427443,-0.007731358,-0.015010148,0.034425285,0.027123867,-0.00015392002,-0.01953582,0.01333565,0.028873794,-0.0017527554,-0.027063524,-0.04347663,0.084660254,0.0140145,0.008093412,-0.041183624,0.0654714,0.05307106,-0.025871763,0.06480764,-0.050989248,0.026716556,0.022085285,-0.008357409,0.022869734,0.010733387,-0.036748465,0.051471986,-0.0031547712,-0.034183916,0.014248327,-0.0037261373,0.024438635,0.042601667,-0.030653892,0.031106459,0.0033640836,-0.021300834,-0.011759207,0.0037676226,0.008515808,0.0008895776,0.030638807,-0.06806612,-0.013863645,-0.051411644,-0.044562794,0.029778928,-0.016714819,-0.027380321,-0.032222793,0.0026418616,0.01831389,0.0022552938,-0.022115456,-0.048756585,-0.037020005,0.060825046,-0.029522473,-0.014783865,-0.004367274,-0.053463284,0.007731358,0.014768779,-0.0065056547,0.05364431,0.029250933,-0.0034206545,0.007369304,0.025343768,0.011706407,-0.011434867,-0.0032075706,-0.025720907,-0.014044671,-0.03487785,-0.041274138,-0.012483315,0.03508905,-0.012490857,-0.023774868,-0.017272985,0.024363207,-0.0118346345,-0.009021175,0.014218156,0.06486798,-0.053161573,0.028903965,-0.018902227,-0.028632425,0.015477802,0.020244844,-0.034908023,-0.01899274,-0.0018715543,0.049058296,0.021738315,-0.00963214,-0.009481285,-0.05132113,-0.015440088,-0.020591812,-0.024574405,-0.007437189,0.02407658,-0.01152538,0.03487785,0.015236433,-0.0010314763,0.0055514923,0.0010163907,-0.01620191,-0.07029878,0.01923411,0.028677681,0.004295618,-0.009586884,0.007127935,-0.033610664,-0.042330127,0.045980837,0.00032551846,-0.0031283714,-0.07108323,0.003654481,-0.013388449,-0.020968951,0.012068462,0.009994195,0.0076597016,0.00995648,-0.011314183,-0.051954724,-0.035752818,-0.00018974827,0.03400289,-0.019897874,-0.020772839,-0.035994187,0.05385551,0.05943717,0.024287779,0.0029548872,0.016910931,-0.024227437,-0.021813743,0.012860454,0.02919059,-0.034726996,-0.009941394,0.01458021,0.0010135622,-0.004423845,-0.0048650983,-0.028044086,-0.045136046,0.014550039,-0.03638641,0.0037544228,-0.00006299407,0.024815774,0.010974756,-0.03714069,0.016699733,-0.0090060895,-0.0045105875,0.0037148232,0.007388161,0.05080822,0.0531314,0.037050176,-0.018027265,0.03433477,-0.006102116,0.05412705,0.0026380902,0.0039825924,-0.0045105875,-0.00025339055,0.05545458,0.014723523,-0.009119231,-0.024664918,0.039644893,0.050687537,0.026309246,-0.031800397,-0.023503328,0.0854447,0.013478963,0.007263705,-0.004393674,-0.0076672444,-0.052980546,-0.0019592391,0.034968365,-0.009850881,-0.029778928,-0.025419196,-0.03186074,-0.011457495,0.013478963,0.011759207,-0.034244258,0.01831389,0.0067696525,-0.033640835,0.021089636,-0.0026230046,-0.0020987808,0.009994195,0.001892297,-0.004076877,0.014006957,0.0776002,-0.023111103,0.012754855,-0.05358397,-0.038075995,0.028813452,-0.0073655327,-0.007814328,-0.034908023,-0.025026971,0.04024832,0.019731933,0.039463867,0.0070298784,0.03683898,-0.0012907597,-0.014859293,-0.03164954,-0.024438635,-0.031498685,0.011977947,-0.031830568,0.001425587,-0.043838684,-0.012679427,-0.027983744,-0.0072976477,-0.005694805,0.032524504,-0.0040316205,-0.03213228,0.0029699728,0.003343341,-0.017725552,-0.012702055,0.0055062356,-0.011231212,-0.017876409,0.0019724392,0.059044946,0.011087899,-0.03164954,-0.01130664,0.045618784,0.025554966,-0.002017696,-0.05331243,-0.011872348,-0.03487785,-0.024619661,0.0094209425,-0.055846803,-0.0005987088,-0.03539076,0.018012179,-0.048816927,0.01006208,0.031830568,0.02642993,-0.014293584,-0.03792514,0.034485627,0.036688123,-0.0343046,-0.028873794,0.00500464,-0.0063585704,0.00422019,0.008183925,0.019973304,-0.015145918,0.011600808,0.004337103,-0.007942556,0.01936988,-0.010688131,-0.02775746,-0.0043031606,-0.0124531435,-0.0077917003,0.034938194,0.012181603,-0.010175222,0.017635038,-0.0030906575,0.0056684054,-0.021376261,-0.009865967,-0.019671591,0.005476064,0.031106459,-0.019596163,-0.020546556,-0.011970405,-0.010884243,-0.0054345788,-0.013131995,0.01844966,0.012792569,0.00327357,0.030774577,0.038317364,-0.013871187,0.02093878,-0.0112462975,-0.03348998,-0.009021175,-0.001164418,0.01674499,0.001636785,-0.01844966,0.0013878731,0.029794013,0.011397153,-0.003543225,-0.023111103,-0.005068754,0.0060493164,0.013773131,0.011329268,0.003249056,0.010763559,0.02104438,0.02956773,-0.023412814,0.00015415573,-0.005457207,0.015764428,0.008455466,0.01203829,-0.015274147,-0.02302059,-0.019354794,-0.052950375,-0.015304318,0.022522766,0.030276751,-0.00018597687,-0.029914698,-0.019565992,0.011887434,0.009609512,-0.01647345,-0.013659989,-0.010280821,-0.007874671,0.0004412531,-0.0026286617,-0.009390771,-0.01347142,-0.03213228,0.025042057,-0.028843623,0.012008118,0.010077165,0.0047708135,0.016775161,0.0031246,-0.04076123,0.012438058,-0.009601969,-0.0065320544,0.011087899,-0.021436604,0.012023204,-0.00043206033,0.016699733,-0.055695947,0.0041787047,-0.005242238,-0.008410209,0.016820418,0.012083547,-0.0037732797,0.0118346345,0.009066432,-0.01899274,0.025901934,0.012076004,-0.025856677,0.031770226,-0.008991004,0.015885113,-0.01660922,0.01923411,0.029809099,0.020772839,-0.03741223,-0.016051054,0.0059399456,0.043355945,-0.019837532,0.008862776,0.022040028,-0.0033037413,-0.0024872343,0.006550912,0.022960247,-0.0171523,-0.011404696,-0.0106277885,0.009722654,-0.0008429066,0.00435596,-0.032102108,0.005894689,-0.0075955875,0.021406433,-0.014927178,-0.019113425,0.020893523,0.005117782,0.009828253,0.015145918,0.023654183,0.021406433,0.0007523931,0.02526834,0.028556997,0.0045558442,-0.0074673602,-0.019053083,-0.013629818,-0.0017480411,-0.040429346,-0.007290105,0.028677681,-0.013780674,-0.0039335643,0.014150271,-0.00086789206,-0.037502743,-0.0137957595,0.005174353,0.003579053,-0.03686915,0.0006590511,0.011555552,0.037532914,0.008048155,0.004959383,-0.009307801,-0.011427324,-0.05282969,-0.0053440654,-0.025072228,-0.022583108,0.015055405,-0.0017282413,0.0046237293,0.015289232,0.0028794594,0.024167094,-0.023397729,0.018163035,0.011472581,0.0041673905,-0.026897583,0.003903393,0.0124531435,-0.00018597687,0.012777483,-0.02210037,-0.022040028,0.01623208,-0.015183632,0.00067366526,0.019430222,-0.0093606,0.0010673045,0.017876409,0.02012416,-0.027425578,0.0014369012,0.02199477,0.006882794,-0.008100955,0.05445893,-0.01295851,-0.0065659974,0.011864806,-0.0010173336,-0.0017904694,-0.0019516965,0.008274439,-0.015221347,0.017589781,0.01130664,0.00020884095,-0.047489394,0.0016414993,-0.0030699149,-0.03113663,-0.0026173475,0.018012179,-0.013139538,-0.009647226,0.030925432,-0.007693644,0.01923411,0.015010148,0.0083875805,-0.008968376,-0.010771101,-0.0106956735,-0.0140145,-0.025313597,0.01728807,-0.0034696825,-0.038558733,0.0061473725,0.018540174,0.04051986,0.0052384664,0.014316212,0.026067875,0.007014793,0.009737739]]')) b, (select * from hybrid_search_collection where vmatch(sparse, 'IP', '[{\"4286132664\":0.1764169,\"2908500734\":0.1764169,\"3393248851\":0.1764169,\"3954549046\":0.1764169,\"3356750231\":0.1764169,\"863271227\":0.11791545}]')) c  limit 1";

    LoadCollectionReq loadCollectionReq = LoadCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.loadCollection(loadCollectionReq);

    MilvusQuerier milvusQuerier = new MilvusQuerier(milvusClient);
    RecordSet recordSet = milvusQuerier.query(sql);

    ReleaseCollectionReq releaseCollectionReq = ReleaseCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.releaseCollection(releaseCollectionReq);

    System.out.println(recordSet.getRecords().size());
  }

  @Test
  public void query2() throws IOException {
    String collection  = "hybrid_search_collection";
    String sql = "select * from hybrid_search_collection a, (select * from hybrid_search_collection where vmatch(dense, 'L2', '[[-0.013192337,-0.026113132,0.06800578,0.0114197815,0.042541325,0.02653553,-0.028722938,-0.032343477,0.043144748,0.08230691,0.039494038,-0.1615967,-0.1160986,0.08284999,-0.0882808,-0.009473742,0.025358854,-0.07379864,0.008727006,-0.004182476,-0.037201032,-0.021602545,0.08351375,-0.072833166,-0.13625292,-0.011163327,0.034908023,0.010288363,0.052618492,-0.16569997,-0.02827037,-0.03689932,-0.05216592,-0.077358834,-0.120865636,0.034908023,0.013758046,-0.11241771,-0.104633555,-0.14602838,0.026309246,-0.09781488,-0.032554675,0.04966172,0.03024658,0.03876993,-0.014912092,-0.0139013585,0.057958785,0.030427609,0.030261666,0.069031596,-0.07096255,0.15483835,-0.17752707,-0.13202897,-0.014512325,0.03433477,-0.08423786,-0.04815316,0.0027946031,0.07856568,-0.045196388,0.017499268,0.10915923,0.05967854,-0.035933845,-0.0021610088,-0.037321717,-0.065531746,0.06879023,0.017107043,0.0037336801,-0.027531177,-0.041937903,-0.0026173475,-0.0071731918,0.07458309,0.06559209,-0.007919928,0.038166508,-0.030925432,-0.09962515,-0.064747296,-0.018706115,-0.04637306,-0.11561586,0.034938194,0.007214677,0.048273847,-0.0016075567,-0.08284999,0.026369588,-0.038377706,0.020727582,-0.013373364,-0.022673622,-0.013433706,0.012392801,0.03632607,-0.06426456,0.054036535,-0.040881913,0.020199588,0.059256144,0.013629818,0.05995008,-0.040851742,-0.103547394,0.038860444,-0.02550971,-0.016020883,-0.017997093,0.042209443,0.07615199,0.004257904,0.03846822,0.030231494,0.0073240474,0.0040617916,-0.0047217854,0.15592451,-0.0122796595,-0.035511445,0.021964598,0.034455456,0.08079835,-0.10849547,0.050295312,-0.037020005,0.027516091,0.060402647,0.0028096887,-0.049299665,-0.0737383,-0.08134143,0.026203647,-0.04739888,0.02199477,-0.03213228,0.06559209,0.06806612,0.0423603,0.0060794875,-0.024876116,0.006004059,0.035692476,0.072531454,-0.065773115,0.03852856,-0.039463867,-0.01060516,-0.020199588,0.06486798,-0.017076872,0.05675194,-0.028813452,0.010190307,0.047791105,0.008463008,0.03379169,-0.01444444,-0.00059965166,0.08128109,-0.014316212,-0.0026475186,-0.028858708,-0.021662887,-0.010854072,0.02861734,0.02250768,-0.0069808504,0.008749634,0.008191468,-0.019747019,-0.017499268,-0.02513257,0.041726705,-0.010514647,0.05892426,0.02956773,-0.0062642857,-0.053433113,0.02104438,-0.01688076,-0.07168666,0.03539076,0.0071241637,0.050868563,-0.041243967,0.006592397,0.023955895,-0.068971254,-0.055394236,-0.011563094,0.028964307,-0.016307509,-0.056208856,-0.0502048,-0.033640835,0.0104543045,-0.033308953,0.11670202,0.012490857,-0.032071937,0.009948937,0.0077238153,-0.03683898,-0.018872056,-0.01844966,0.0027342606,-0.015304318,-0.05732519,-0.020712497,0.0441404,-0.012068462,0.03514939,0.025057143,0.015734257,-0.04136465,-0.035722647,-0.0059286314,0.010725845,-0.019022912,0.034515798,-0.029718585,0.024498977,-0.045890324,0.029990125,-0.010167679,-0.07072118,-0.017997093,0.019656505,0.032373648,-0.019384965,-0.03427443,-0.007731358,-0.015010148,0.034425285,0.027123867,-0.00015392002,-0.01953582,0.01333565,0.028873794,-0.0017527554,-0.027063524,-0.04347663,0.084660254,0.0140145,0.008093412,-0.041183624,0.0654714,0.05307106,-0.025871763,0.06480764,-0.050989248,0.026716556,0.022085285,-0.008357409,0.022869734,0.010733387,-0.036748465,0.051471986,-0.0031547712,-0.034183916,0.014248327,-0.0037261373,0.024438635,0.042601667,-0.030653892,0.031106459,0.0033640836,-0.021300834,-0.011759207,0.0037676226,0.008515808,0.0008895776,0.030638807,-0.06806612,-0.013863645,-0.051411644,-0.044562794,0.029778928,-0.016714819,-0.027380321,-0.032222793,0.0026418616,0.01831389,0.0022552938,-0.022115456,-0.048756585,-0.037020005,0.060825046,-0.029522473,-0.014783865,-0.004367274,-0.053463284,0.007731358,0.014768779,-0.0065056547,0.05364431,0.029250933,-0.0034206545,0.007369304,0.025343768,0.011706407,-0.011434867,-0.0032075706,-0.025720907,-0.014044671,-0.03487785,-0.041274138,-0.012483315,0.03508905,-0.012490857,-0.023774868,-0.017272985,0.024363207,-0.0118346345,-0.009021175,0.014218156,0.06486798,-0.053161573,0.028903965,-0.018902227,-0.028632425,0.015477802,0.020244844,-0.034908023,-0.01899274,-0.0018715543,0.049058296,0.021738315,-0.00963214,-0.009481285,-0.05132113,-0.015440088,-0.020591812,-0.024574405,-0.007437189,0.02407658,-0.01152538,0.03487785,0.015236433,-0.0010314763,0.0055514923,0.0010163907,-0.01620191,-0.07029878,0.01923411,0.028677681,0.004295618,-0.009586884,0.007127935,-0.033610664,-0.042330127,0.045980837,0.00032551846,-0.0031283714,-0.07108323,0.003654481,-0.013388449,-0.020968951,0.012068462,0.009994195,0.0076597016,0.00995648,-0.011314183,-0.051954724,-0.035752818,-0.00018974827,0.03400289,-0.019897874,-0.020772839,-0.035994187,0.05385551,0.05943717,0.024287779,0.0029548872,0.016910931,-0.024227437,-0.021813743,0.012860454,0.02919059,-0.034726996,-0.009941394,0.01458021,0.0010135622,-0.004423845,-0.0048650983,-0.028044086,-0.045136046,0.014550039,-0.03638641,0.0037544228,-0.00006299407,0.024815774,0.010974756,-0.03714069,0.016699733,-0.0090060895,-0.0045105875,0.0037148232,0.007388161,0.05080822,0.0531314,0.037050176,-0.018027265,0.03433477,-0.006102116,0.05412705,0.0026380902,0.0039825924,-0.0045105875,-0.00025339055,0.05545458,0.014723523,-0.009119231,-0.024664918,0.039644893,0.050687537,0.026309246,-0.031800397,-0.023503328,0.0854447,0.013478963,0.007263705,-0.004393674,-0.0076672444,-0.052980546,-0.0019592391,0.034968365,-0.009850881,-0.029778928,-0.025419196,-0.03186074,-0.011457495,0.013478963,0.011759207,-0.034244258,0.01831389,0.0067696525,-0.033640835,0.021089636,-0.0026230046,-0.0020987808,0.009994195,0.001892297,-0.004076877,0.014006957,0.0776002,-0.023111103,0.012754855,-0.05358397,-0.038075995,0.028813452,-0.0073655327,-0.007814328,-0.034908023,-0.025026971,0.04024832,0.019731933,0.039463867,0.0070298784,0.03683898,-0.0012907597,-0.014859293,-0.03164954,-0.024438635,-0.031498685,0.011977947,-0.031830568,0.001425587,-0.043838684,-0.012679427,-0.027983744,-0.0072976477,-0.005694805,0.032524504,-0.0040316205,-0.03213228,0.0029699728,0.003343341,-0.017725552,-0.012702055,0.0055062356,-0.011231212,-0.017876409,0.0019724392,0.059044946,0.011087899,-0.03164954,-0.01130664,0.045618784,0.025554966,-0.002017696,-0.05331243,-0.011872348,-0.03487785,-0.024619661,0.0094209425,-0.055846803,-0.0005987088,-0.03539076,0.018012179,-0.048816927,0.01006208,0.031830568,0.02642993,-0.014293584,-0.03792514,0.034485627,0.036688123,-0.0343046,-0.028873794,0.00500464,-0.0063585704,0.00422019,0.008183925,0.019973304,-0.015145918,0.011600808,0.004337103,-0.007942556,0.01936988,-0.010688131,-0.02775746,-0.0043031606,-0.0124531435,-0.0077917003,0.034938194,0.012181603,-0.010175222,0.017635038,-0.0030906575,0.0056684054,-0.021376261,-0.009865967,-0.019671591,0.005476064,0.031106459,-0.019596163,-0.020546556,-0.011970405,-0.010884243,-0.0054345788,-0.013131995,0.01844966,0.012792569,0.00327357,0.030774577,0.038317364,-0.013871187,0.02093878,-0.0112462975,-0.03348998,-0.009021175,-0.001164418,0.01674499,0.001636785,-0.01844966,0.0013878731,0.029794013,0.011397153,-0.003543225,-0.023111103,-0.005068754,0.0060493164,0.013773131,0.011329268,0.003249056,0.010763559,0.02104438,0.02956773,-0.023412814,0.00015415573,-0.005457207,0.015764428,0.008455466,0.01203829,-0.015274147,-0.02302059,-0.019354794,-0.052950375,-0.015304318,0.022522766,0.030276751,-0.00018597687,-0.029914698,-0.019565992,0.011887434,0.009609512,-0.01647345,-0.013659989,-0.010280821,-0.007874671,0.0004412531,-0.0026286617,-0.009390771,-0.01347142,-0.03213228,0.025042057,-0.028843623,0.012008118,0.010077165,0.0047708135,0.016775161,0.0031246,-0.04076123,0.012438058,-0.009601969,-0.0065320544,0.011087899,-0.021436604,0.012023204,-0.00043206033,0.016699733,-0.055695947,0.0041787047,-0.005242238,-0.008410209,0.016820418,0.012083547,-0.0037732797,0.0118346345,0.009066432,-0.01899274,0.025901934,0.012076004,-0.025856677,0.031770226,-0.008991004,0.015885113,-0.01660922,0.01923411,0.029809099,0.020772839,-0.03741223,-0.016051054,0.0059399456,0.043355945,-0.019837532,0.008862776,0.022040028,-0.0033037413,-0.0024872343,0.006550912,0.022960247,-0.0171523,-0.011404696,-0.0106277885,0.009722654,-0.0008429066,0.00435596,-0.032102108,0.005894689,-0.0075955875,0.021406433,-0.014927178,-0.019113425,0.020893523,0.005117782,0.009828253,0.015145918,0.023654183,0.021406433,0.0007523931,0.02526834,0.028556997,0.0045558442,-0.0074673602,-0.019053083,-0.013629818,-0.0017480411,-0.040429346,-0.007290105,0.028677681,-0.013780674,-0.0039335643,0.014150271,-0.00086789206,-0.037502743,-0.0137957595,0.005174353,0.003579053,-0.03686915,0.0006590511,0.011555552,0.037532914,0.008048155,0.004959383,-0.009307801,-0.011427324,-0.05282969,-0.0053440654,-0.025072228,-0.022583108,0.015055405,-0.0017282413,0.0046237293,0.015289232,0.0028794594,0.024167094,-0.023397729,0.018163035,0.011472581,0.0041673905,-0.026897583,0.003903393,0.0124531435,-0.00018597687,0.012777483,-0.02210037,-0.022040028,0.01623208,-0.015183632,0.00067366526,0.019430222,-0.0093606,0.0010673045,0.017876409,0.02012416,-0.027425578,0.0014369012,0.02199477,0.006882794,-0.008100955,0.05445893,-0.01295851,-0.0065659974,0.011864806,-0.0010173336,-0.0017904694,-0.0019516965,0.008274439,-0.015221347,0.017589781,0.01130664,0.00020884095,-0.047489394,0.0016414993,-0.0030699149,-0.03113663,-0.0026173475,0.018012179,-0.013139538,-0.009647226,0.030925432,-0.007693644,0.01923411,0.015010148,0.0083875805,-0.008968376,-0.010771101,-0.0106956735,-0.0140145,-0.025313597,0.01728807,-0.0034696825,-0.038558733,0.0061473725,0.018540174,0.04051986,0.0052384664,0.014316212,0.026067875,0.007014793,0.009737739]]')) b, (select * from hybrid_search_collection where vmatch(sparse, 'IP', '[{\"4286132664\":0.1764169,\"2908500734\":0.1764169,\"3393248851\":0.1764169,\"3954549046\":0.1764169,\"3356750231\":0.1764169,\"863271227\":0.11791545}]')) c  limit 1";

    LoadCollectionReq loadCollectionReq = LoadCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.loadCollection(loadCollectionReq);

    MilvusQuerier milvusQuerier = new MilvusQuerier(milvusClient);
    RecordSet recordSet = milvusQuerier.query(sql);

    ReleaseCollectionReq releaseCollectionReq = ReleaseCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.releaseCollection(releaseCollectionReq);

    System.out.println(recordSet.getRecords().size());
  }

  @Test
  public void query3() throws IOException {
    String collection  = "hybrid_search_collection";
    String sql = "select * from hybrid_search_collection a, (select * from hybrid_search_collection where vmatch(dense, 'L2', '[[-0.013192337,-0.026113132,0.06800578,0.0114197815,0.042541325,0.02653553,-0.028722938,-0.032343477,0.043144748,0.08230691,0.039494038,-0.1615967,-0.1160986,0.08284999,-0.0882808,-0.009473742,0.025358854,-0.07379864,0.008727006,-0.004182476,-0.037201032,-0.021602545,0.08351375,-0.072833166,-0.13625292,-0.011163327,0.034908023,0.010288363,0.052618492,-0.16569997,-0.02827037,-0.03689932,-0.05216592,-0.077358834,-0.120865636,0.034908023,0.013758046,-0.11241771,-0.104633555,-0.14602838,0.026309246,-0.09781488,-0.032554675,0.04966172,0.03024658,0.03876993,-0.014912092,-0.0139013585,0.057958785,0.030427609,0.030261666,0.069031596,-0.07096255,0.15483835,-0.17752707,-0.13202897,-0.014512325,0.03433477,-0.08423786,-0.04815316,0.0027946031,0.07856568,-0.045196388,0.017499268,0.10915923,0.05967854,-0.035933845,-0.0021610088,-0.037321717,-0.065531746,0.06879023,0.017107043,0.0037336801,-0.027531177,-0.041937903,-0.0026173475,-0.0071731918,0.07458309,0.06559209,-0.007919928,0.038166508,-0.030925432,-0.09962515,-0.064747296,-0.018706115,-0.04637306,-0.11561586,0.034938194,0.007214677,0.048273847,-0.0016075567,-0.08284999,0.026369588,-0.038377706,0.020727582,-0.013373364,-0.022673622,-0.013433706,0.012392801,0.03632607,-0.06426456,0.054036535,-0.040881913,0.020199588,0.059256144,0.013629818,0.05995008,-0.040851742,-0.103547394,0.038860444,-0.02550971,-0.016020883,-0.017997093,0.042209443,0.07615199,0.004257904,0.03846822,0.030231494,0.0073240474,0.0040617916,-0.0047217854,0.15592451,-0.0122796595,-0.035511445,0.021964598,0.034455456,0.08079835,-0.10849547,0.050295312,-0.037020005,0.027516091,0.060402647,0.0028096887,-0.049299665,-0.0737383,-0.08134143,0.026203647,-0.04739888,0.02199477,-0.03213228,0.06559209,0.06806612,0.0423603,0.0060794875,-0.024876116,0.006004059,0.035692476,0.072531454,-0.065773115,0.03852856,-0.039463867,-0.01060516,-0.020199588,0.06486798,-0.017076872,0.05675194,-0.028813452,0.010190307,0.047791105,0.008463008,0.03379169,-0.01444444,-0.00059965166,0.08128109,-0.014316212,-0.0026475186,-0.028858708,-0.021662887,-0.010854072,0.02861734,0.02250768,-0.0069808504,0.008749634,0.008191468,-0.019747019,-0.017499268,-0.02513257,0.041726705,-0.010514647,0.05892426,0.02956773,-0.0062642857,-0.053433113,0.02104438,-0.01688076,-0.07168666,0.03539076,0.0071241637,0.050868563,-0.041243967,0.006592397,0.023955895,-0.068971254,-0.055394236,-0.011563094,0.028964307,-0.016307509,-0.056208856,-0.0502048,-0.033640835,0.0104543045,-0.033308953,0.11670202,0.012490857,-0.032071937,0.009948937,0.0077238153,-0.03683898,-0.018872056,-0.01844966,0.0027342606,-0.015304318,-0.05732519,-0.020712497,0.0441404,-0.012068462,0.03514939,0.025057143,0.015734257,-0.04136465,-0.035722647,-0.0059286314,0.010725845,-0.019022912,0.034515798,-0.029718585,0.024498977,-0.045890324,0.029990125,-0.010167679,-0.07072118,-0.017997093,0.019656505,0.032373648,-0.019384965,-0.03427443,-0.007731358,-0.015010148,0.034425285,0.027123867,-0.00015392002,-0.01953582,0.01333565,0.028873794,-0.0017527554,-0.027063524,-0.04347663,0.084660254,0.0140145,0.008093412,-0.041183624,0.0654714,0.05307106,-0.025871763,0.06480764,-0.050989248,0.026716556,0.022085285,-0.008357409,0.022869734,0.010733387,-0.036748465,0.051471986,-0.0031547712,-0.034183916,0.014248327,-0.0037261373,0.024438635,0.042601667,-0.030653892,0.031106459,0.0033640836,-0.021300834,-0.011759207,0.0037676226,0.008515808,0.0008895776,0.030638807,-0.06806612,-0.013863645,-0.051411644,-0.044562794,0.029778928,-0.016714819,-0.027380321,-0.032222793,0.0026418616,0.01831389,0.0022552938,-0.022115456,-0.048756585,-0.037020005,0.060825046,-0.029522473,-0.014783865,-0.004367274,-0.053463284,0.007731358,0.014768779,-0.0065056547,0.05364431,0.029250933,-0.0034206545,0.007369304,0.025343768,0.011706407,-0.011434867,-0.0032075706,-0.025720907,-0.014044671,-0.03487785,-0.041274138,-0.012483315,0.03508905,-0.012490857,-0.023774868,-0.017272985,0.024363207,-0.0118346345,-0.009021175,0.014218156,0.06486798,-0.053161573,0.028903965,-0.018902227,-0.028632425,0.015477802,0.020244844,-0.034908023,-0.01899274,-0.0018715543,0.049058296,0.021738315,-0.00963214,-0.009481285,-0.05132113,-0.015440088,-0.020591812,-0.024574405,-0.007437189,0.02407658,-0.01152538,0.03487785,0.015236433,-0.0010314763,0.0055514923,0.0010163907,-0.01620191,-0.07029878,0.01923411,0.028677681,0.004295618,-0.009586884,0.007127935,-0.033610664,-0.042330127,0.045980837,0.00032551846,-0.0031283714,-0.07108323,0.003654481,-0.013388449,-0.020968951,0.012068462,0.009994195,0.0076597016,0.00995648,-0.011314183,-0.051954724,-0.035752818,-0.00018974827,0.03400289,-0.019897874,-0.020772839,-0.035994187,0.05385551,0.05943717,0.024287779,0.0029548872,0.016910931,-0.024227437,-0.021813743,0.012860454,0.02919059,-0.034726996,-0.009941394,0.01458021,0.0010135622,-0.004423845,-0.0048650983,-0.028044086,-0.045136046,0.014550039,-0.03638641,0.0037544228,-0.00006299407,0.024815774,0.010974756,-0.03714069,0.016699733,-0.0090060895,-0.0045105875,0.0037148232,0.007388161,0.05080822,0.0531314,0.037050176,-0.018027265,0.03433477,-0.006102116,0.05412705,0.0026380902,0.0039825924,-0.0045105875,-0.00025339055,0.05545458,0.014723523,-0.009119231,-0.024664918,0.039644893,0.050687537,0.026309246,-0.031800397,-0.023503328,0.0854447,0.013478963,0.007263705,-0.004393674,-0.0076672444,-0.052980546,-0.0019592391,0.034968365,-0.009850881,-0.029778928,-0.025419196,-0.03186074,-0.011457495,0.013478963,0.011759207,-0.034244258,0.01831389,0.0067696525,-0.033640835,0.021089636,-0.0026230046,-0.0020987808,0.009994195,0.001892297,-0.004076877,0.014006957,0.0776002,-0.023111103,0.012754855,-0.05358397,-0.038075995,0.028813452,-0.0073655327,-0.007814328,-0.034908023,-0.025026971,0.04024832,0.019731933,0.039463867,0.0070298784,0.03683898,-0.0012907597,-0.014859293,-0.03164954,-0.024438635,-0.031498685,0.011977947,-0.031830568,0.001425587,-0.043838684,-0.012679427,-0.027983744,-0.0072976477,-0.005694805,0.032524504,-0.0040316205,-0.03213228,0.0029699728,0.003343341,-0.017725552,-0.012702055,0.0055062356,-0.011231212,-0.017876409,0.0019724392,0.059044946,0.011087899,-0.03164954,-0.01130664,0.045618784,0.025554966,-0.002017696,-0.05331243,-0.011872348,-0.03487785,-0.024619661,0.0094209425,-0.055846803,-0.0005987088,-0.03539076,0.018012179,-0.048816927,0.01006208,0.031830568,0.02642993,-0.014293584,-0.03792514,0.034485627,0.036688123,-0.0343046,-0.028873794,0.00500464,-0.0063585704,0.00422019,0.008183925,0.019973304,-0.015145918,0.011600808,0.004337103,-0.007942556,0.01936988,-0.010688131,-0.02775746,-0.0043031606,-0.0124531435,-0.0077917003,0.034938194,0.012181603,-0.010175222,0.017635038,-0.0030906575,0.0056684054,-0.021376261,-0.009865967,-0.019671591,0.005476064,0.031106459,-0.019596163,-0.020546556,-0.011970405,-0.010884243,-0.0054345788,-0.013131995,0.01844966,0.012792569,0.00327357,0.030774577,0.038317364,-0.013871187,0.02093878,-0.0112462975,-0.03348998,-0.009021175,-0.001164418,0.01674499,0.001636785,-0.01844966,0.0013878731,0.029794013,0.011397153,-0.003543225,-0.023111103,-0.005068754,0.0060493164,0.013773131,0.011329268,0.003249056,0.010763559,0.02104438,0.02956773,-0.023412814,0.00015415573,-0.005457207,0.015764428,0.008455466,0.01203829,-0.015274147,-0.02302059,-0.019354794,-0.052950375,-0.015304318,0.022522766,0.030276751,-0.00018597687,-0.029914698,-0.019565992,0.011887434,0.009609512,-0.01647345,-0.013659989,-0.010280821,-0.007874671,0.0004412531,-0.0026286617,-0.009390771,-0.01347142,-0.03213228,0.025042057,-0.028843623,0.012008118,0.010077165,0.0047708135,0.016775161,0.0031246,-0.04076123,0.012438058,-0.009601969,-0.0065320544,0.011087899,-0.021436604,0.012023204,-0.00043206033,0.016699733,-0.055695947,0.0041787047,-0.005242238,-0.008410209,0.016820418,0.012083547,-0.0037732797,0.0118346345,0.009066432,-0.01899274,0.025901934,0.012076004,-0.025856677,0.031770226,-0.008991004,0.015885113,-0.01660922,0.01923411,0.029809099,0.020772839,-0.03741223,-0.016051054,0.0059399456,0.043355945,-0.019837532,0.008862776,0.022040028,-0.0033037413,-0.0024872343,0.006550912,0.022960247,-0.0171523,-0.011404696,-0.0106277885,0.009722654,-0.0008429066,0.00435596,-0.032102108,0.005894689,-0.0075955875,0.021406433,-0.014927178,-0.019113425,0.020893523,0.005117782,0.009828253,0.015145918,0.023654183,0.021406433,0.0007523931,0.02526834,0.028556997,0.0045558442,-0.0074673602,-0.019053083,-0.013629818,-0.0017480411,-0.040429346,-0.007290105,0.028677681,-0.013780674,-0.0039335643,0.014150271,-0.00086789206,-0.037502743,-0.0137957595,0.005174353,0.003579053,-0.03686915,0.0006590511,0.011555552,0.037532914,0.008048155,0.004959383,-0.009307801,-0.011427324,-0.05282969,-0.0053440654,-0.025072228,-0.022583108,0.015055405,-0.0017282413,0.0046237293,0.015289232,0.0028794594,0.024167094,-0.023397729,0.018163035,0.011472581,0.0041673905,-0.026897583,0.003903393,0.0124531435,-0.00018597687,0.012777483,-0.02210037,-0.022040028,0.01623208,-0.015183632,0.00067366526,0.019430222,-0.0093606,0.0010673045,0.017876409,0.02012416,-0.027425578,0.0014369012,0.02199477,0.006882794,-0.008100955,0.05445893,-0.01295851,-0.0065659974,0.011864806,-0.0010173336,-0.0017904694,-0.0019516965,0.008274439,-0.015221347,0.017589781,0.01130664,0.00020884095,-0.047489394,0.0016414993,-0.0030699149,-0.03113663,-0.0026173475,0.018012179,-0.013139538,-0.009647226,0.030925432,-0.007693644,0.01923411,0.015010148,0.0083875805,-0.008968376,-0.010771101,-0.0106956735,-0.0140145,-0.025313597,0.01728807,-0.0034696825,-0.038558733,0.0061473725,0.018540174,0.04051986,0.0052384664,0.014316212,0.026067875,0.007014793,0.009737739]]')) b, (select * from hybrid_search_collection where vmatch(sparse, 'IP', '[{\"4286132664\":0.1764169,\"2908500734\":0.1764169,\"3393248851\":0.1764169,\"3954549046\":0.1764169,\"3356750231\":0.1764169,\"863271227\":0.11791545}]')) c  limit 1";

    LoadCollectionReq loadCollectionReq = LoadCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.loadCollection(loadCollectionReq);

    MilvusQuerier milvusQuerier = new MilvusQuerier(milvusClient);
    RecordSet recordSet = milvusQuerier.query(sql);

    ReleaseCollectionReq releaseCollectionReq = ReleaseCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.releaseCollection(releaseCollectionReq);

    System.out.println(recordSet.getRecords().size());
  }



  @Test
  public void query4() throws IOException {
    String collection  = "hybrid_search_collection";

    LoadCollectionReq loadCollectionReq = LoadCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.loadCollection(loadCollectionReq);

    String sql = "select * from hybrid_search_collection where vMatch(sparse, 'IP', '[{\"4286132664\":0.1764169,\"2908500734\":0.1764169,\"3393248851\":0.1764169,\"3954549046\":0.1764169,\"3356750231\":0.1764169,\"863271227\":0.11791545}]') limit 0,1";

    System.out.println(sql);



    MilvusQuerier milvusQuerier = new MilvusQuerier(milvusClient);
    RecordSet recordSet = milvusQuerier.query(sql);

    System.out.println(recordSet.getRecords().size());

    ReleaseCollectionReq releaseCollectionReq = ReleaseCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.releaseCollection(releaseCollectionReq);
  }

  @Test
  public void query5() throws IOException {
    String collection  = "hybrid_search_collection";

    LoadCollectionReq loadCollectionReq = LoadCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.loadCollection(loadCollectionReq);

    String sql = "select * from hybrid_search_collection where vMatch(dense, 'L2', '[[-0.013192337,-0.026113132,0.06800578,0.0114197815,0.042541325,0.02653553,-0.028722938,-0.032343477,0.043144748,0.08230691,0.039494038,-0.1615967,-0.1160986,0.08284999,-0.0882808,-0.009473742,0.025358854,-0.07379864,0.008727006,-0.004182476,-0.037201032,-0.021602545,0.08351375,-0.072833166,-0.13625292,-0.011163327,0.034908023,0.010288363,0.052618492,-0.16569997,-0.02827037,-0.03689932,-0.05216592,-0.077358834,-0.120865636,0.034908023,0.013758046,-0.11241771,-0.104633555,-0.14602838,0.026309246,-0.09781488,-0.032554675,0.04966172,0.03024658,0.03876993,-0.014912092,-0.0139013585,0.057958785,0.030427609,0.030261666,0.069031596,-0.07096255,0.15483835,-0.17752707,-0.13202897,-0.014512325,0.03433477,-0.08423786,-0.04815316,0.0027946031,0.07856568,-0.045196388,0.017499268,0.10915923,0.05967854,-0.035933845,-0.0021610088,-0.037321717,-0.065531746,0.06879023,0.017107043,0.0037336801,-0.027531177,-0.041937903,-0.0026173475,-0.0071731918,0.07458309,0.06559209,-0.007919928,0.038166508,-0.030925432,-0.09962515,-0.064747296,-0.018706115,-0.04637306,-0.11561586,0.034938194,0.007214677,0.048273847,-0.0016075567,-0.08284999,0.026369588,-0.038377706,0.020727582,-0.013373364,-0.022673622,-0.013433706,0.012392801,0.03632607,-0.06426456,0.054036535,-0.040881913,0.020199588,0.059256144,0.013629818,0.05995008,-0.040851742,-0.103547394,0.038860444,-0.02550971,-0.016020883,-0.017997093,0.042209443,0.07615199,0.004257904,0.03846822,0.030231494,0.0073240474,0.0040617916,-0.0047217854,0.15592451,-0.0122796595,-0.035511445,0.021964598,0.034455456,0.08079835,-0.10849547,0.050295312,-0.037020005,0.027516091,0.060402647,0.0028096887,-0.049299665,-0.0737383,-0.08134143,0.026203647,-0.04739888,0.02199477,-0.03213228,0.06559209,0.06806612,0.0423603,0.0060794875,-0.024876116,0.006004059,0.035692476,0.072531454,-0.065773115,0.03852856,-0.039463867,-0.01060516,-0.020199588,0.06486798,-0.017076872,0.05675194,-0.028813452,0.010190307,0.047791105,0.008463008,0.03379169,-0.01444444,-0.00059965166,0.08128109,-0.014316212,-0.0026475186,-0.028858708,-0.021662887,-0.010854072,0.02861734,0.02250768,-0.0069808504,0.008749634,0.008191468,-0.019747019,-0.017499268,-0.02513257,0.041726705,-0.010514647,0.05892426,0.02956773,-0.0062642857,-0.053433113,0.02104438,-0.01688076,-0.07168666,0.03539076,0.0071241637,0.050868563,-0.041243967,0.006592397,0.023955895,-0.068971254,-0.055394236,-0.011563094,0.028964307,-0.016307509,-0.056208856,-0.0502048,-0.033640835,0.0104543045,-0.033308953,0.11670202,0.012490857,-0.032071937,0.009948937,0.0077238153,-0.03683898,-0.018872056,-0.01844966,0.0027342606,-0.015304318,-0.05732519,-0.020712497,0.0441404,-0.012068462,0.03514939,0.025057143,0.015734257,-0.04136465,-0.035722647,-0.0059286314,0.010725845,-0.019022912,0.034515798,-0.029718585,0.024498977,-0.045890324,0.029990125,-0.010167679,-0.07072118,-0.017997093,0.019656505,0.032373648,-0.019384965,-0.03427443,-0.007731358,-0.015010148,0.034425285,0.027123867,-0.00015392002,-0.01953582,0.01333565,0.028873794,-0.0017527554,-0.027063524,-0.04347663,0.084660254,0.0140145,0.008093412,-0.041183624,0.0654714,0.05307106,-0.025871763,0.06480764,-0.050989248,0.026716556,0.022085285,-0.008357409,0.022869734,0.010733387,-0.036748465,0.051471986,-0.0031547712,-0.034183916,0.014248327,-0.0037261373,0.024438635,0.042601667,-0.030653892,0.031106459,0.0033640836,-0.021300834,-0.011759207,0.0037676226,0.008515808,0.0008895776,0.030638807,-0.06806612,-0.013863645,-0.051411644,-0.044562794,0.029778928,-0.016714819,-0.027380321,-0.032222793,0.0026418616,0.01831389,0.0022552938,-0.022115456,-0.048756585,-0.037020005,0.060825046,-0.029522473,-0.014783865,-0.004367274,-0.053463284,0.007731358,0.014768779,-0.0065056547,0.05364431,0.029250933,-0.0034206545,0.007369304,0.025343768,0.011706407,-0.011434867,-0.0032075706,-0.025720907,-0.014044671,-0.03487785,-0.041274138,-0.012483315,0.03508905,-0.012490857,-0.023774868,-0.017272985,0.024363207,-0.0118346345,-0.009021175,0.014218156,0.06486798,-0.053161573,0.028903965,-0.018902227,-0.028632425,0.015477802,0.020244844,-0.034908023,-0.01899274,-0.0018715543,0.049058296,0.021738315,-0.00963214,-0.009481285,-0.05132113,-0.015440088,-0.020591812,-0.024574405,-0.007437189,0.02407658,-0.01152538,0.03487785,0.015236433,-0.0010314763,0.0055514923,0.0010163907,-0.01620191,-0.07029878,0.01923411,0.028677681,0.004295618,-0.009586884,0.007127935,-0.033610664,-0.042330127,0.045980837,0.00032551846,-0.0031283714,-0.07108323,0.003654481,-0.013388449,-0.020968951,0.012068462,0.009994195,0.0076597016,0.00995648,-0.011314183,-0.051954724,-0.035752818,-0.00018974827,0.03400289,-0.019897874,-0.020772839,-0.035994187,0.05385551,0.05943717,0.024287779,0.0029548872,0.016910931,-0.024227437,-0.021813743,0.012860454,0.02919059,-0.034726996,-0.009941394,0.01458021,0.0010135622,-0.004423845,-0.0048650983,-0.028044086,-0.045136046,0.014550039,-0.03638641,0.0037544228,-0.00006299407,0.024815774,0.010974756,-0.03714069,0.016699733,-0.0090060895,-0.0045105875,0.0037148232,0.007388161,0.05080822,0.0531314,0.037050176,-0.018027265,0.03433477,-0.006102116,0.05412705,0.0026380902,0.0039825924,-0.0045105875,-0.00025339055,0.05545458,0.014723523,-0.009119231,-0.024664918,0.039644893,0.050687537,0.026309246,-0.031800397,-0.023503328,0.0854447,0.013478963,0.007263705,-0.004393674,-0.0076672444,-0.052980546,-0.0019592391,0.034968365,-0.009850881,-0.029778928,-0.025419196,-0.03186074,-0.011457495,0.013478963,0.011759207,-0.034244258,0.01831389,0.0067696525,-0.033640835,0.021089636,-0.0026230046,-0.0020987808,0.009994195,0.001892297,-0.004076877,0.014006957,0.0776002,-0.023111103,0.012754855,-0.05358397,-0.038075995,0.028813452,-0.0073655327,-0.007814328,-0.034908023,-0.025026971,0.04024832,0.019731933,0.039463867,0.0070298784,0.03683898,-0.0012907597,-0.014859293,-0.03164954,-0.024438635,-0.031498685,0.011977947,-0.031830568,0.001425587,-0.043838684,-0.012679427,-0.027983744,-0.0072976477,-0.005694805,0.032524504,-0.0040316205,-0.03213228,0.0029699728,0.003343341,-0.017725552,-0.012702055,0.0055062356,-0.011231212,-0.017876409,0.0019724392,0.059044946,0.011087899,-0.03164954,-0.01130664,0.045618784,0.025554966,-0.002017696,-0.05331243,-0.011872348,-0.03487785,-0.024619661,0.0094209425,-0.055846803,-0.0005987088,-0.03539076,0.018012179,-0.048816927,0.01006208,0.031830568,0.02642993,-0.014293584,-0.03792514,0.034485627,0.036688123,-0.0343046,-0.028873794,0.00500464,-0.0063585704,0.00422019,0.008183925,0.019973304,-0.015145918,0.011600808,0.004337103,-0.007942556,0.01936988,-0.010688131,-0.02775746,-0.0043031606,-0.0124531435,-0.0077917003,0.034938194,0.012181603,-0.010175222,0.017635038,-0.0030906575,0.0056684054,-0.021376261,-0.009865967,-0.019671591,0.005476064,0.031106459,-0.019596163,-0.020546556,-0.011970405,-0.010884243,-0.0054345788,-0.013131995,0.01844966,0.012792569,0.00327357,0.030774577,0.038317364,-0.013871187,0.02093878,-0.0112462975,-0.03348998,-0.009021175,-0.001164418,0.01674499,0.001636785,-0.01844966,0.0013878731,0.029794013,0.011397153,-0.003543225,-0.023111103,-0.005068754,0.0060493164,0.013773131,0.011329268,0.003249056,0.010763559,0.02104438,0.02956773,-0.023412814,0.00015415573,-0.005457207,0.015764428,0.008455466,0.01203829,-0.015274147,-0.02302059,-0.019354794,-0.052950375,-0.015304318,0.022522766,0.030276751,-0.00018597687,-0.029914698,-0.019565992,0.011887434,0.009609512,-0.01647345,-0.013659989,-0.010280821,-0.007874671,0.0004412531,-0.0026286617,-0.009390771,-0.01347142,-0.03213228,0.025042057,-0.028843623,0.012008118,0.010077165,0.0047708135,0.016775161,0.0031246,-0.04076123,0.012438058,-0.009601969,-0.0065320544,0.011087899,-0.021436604,0.012023204,-0.00043206033,0.016699733,-0.055695947,0.0041787047,-0.005242238,-0.008410209,0.016820418,0.012083547,-0.0037732797,0.0118346345,0.009066432,-0.01899274,0.025901934,0.012076004,-0.025856677,0.031770226,-0.008991004,0.015885113,-0.01660922,0.01923411,0.029809099,0.020772839,-0.03741223,-0.016051054,0.0059399456,0.043355945,-0.019837532,0.008862776,0.022040028,-0.0033037413,-0.0024872343,0.006550912,0.022960247,-0.0171523,-0.011404696,-0.0106277885,0.009722654,-0.0008429066,0.00435596,-0.032102108,0.005894689,-0.0075955875,0.021406433,-0.014927178,-0.019113425,0.020893523,0.005117782,0.009828253,0.015145918,0.023654183,0.021406433,0.0007523931,0.02526834,0.028556997,0.0045558442,-0.0074673602,-0.019053083,-0.013629818,-0.0017480411,-0.040429346,-0.007290105,0.028677681,-0.013780674,-0.0039335643,0.014150271,-0.00086789206,-0.037502743,-0.0137957595,0.005174353,0.003579053,-0.03686915,0.0006590511,0.011555552,0.037532914,0.008048155,0.004959383,-0.009307801,-0.011427324,-0.05282969,-0.0053440654,-0.025072228,-0.022583108,0.015055405,-0.0017282413,0.0046237293,0.015289232,0.0028794594,0.024167094,-0.023397729,0.018163035,0.011472581,0.0041673905,-0.026897583,0.003903393,0.0124531435,-0.00018597687,0.012777483,-0.02210037,-0.022040028,0.01623208,-0.015183632,0.00067366526,0.019430222,-0.0093606,0.0010673045,0.017876409,0.02012416,-0.027425578,0.0014369012,0.02199477,0.006882794,-0.008100955,0.05445893,-0.01295851,-0.0065659974,0.011864806,-0.0010173336,-0.0017904694,-0.0019516965,0.008274439,-0.015221347,0.017589781,0.01130664,0.00020884095,-0.047489394,0.0016414993,-0.0030699149,-0.03113663,-0.0026173475,0.018012179,-0.013139538,-0.009647226,0.030925432,-0.007693644,0.01923411,0.015010148,0.0083875805,-0.008968376,-0.010771101,-0.0106956735,-0.0140145,-0.025313597,0.01728807,-0.0034696825,-0.038558733,0.0061473725,0.018540174,0.04051986,0.0052384664,0.014316212,0.026067875,0.007014793,0.009737739]]') limit 0,1";

    System.out.println(sql);



    MilvusQuerier milvusQuerier = new MilvusQuerier(milvusClient);
    RecordSet recordSet = milvusQuerier.query(sql);

    System.out.println(recordSet.getRecords().size());

    ReleaseCollectionReq releaseCollectionReq = ReleaseCollectionReq.builder()
        .collectionName(collection)
        .build();

    milvusClient.releaseCollection(releaseCollectionReq);
  }
}
